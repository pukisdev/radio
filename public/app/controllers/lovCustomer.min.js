app.controller('lovCustomerController', function($scope, $http){//, API_URL) {
	$scope.libraryTempCustomer = {};
  $scope.totalItemsTempCustomer = {};
  $scope.totalItemsCustomer = 0;
  $scope.subUrlCustomer = '/pms/customer';
  $scope._token = {};
  $scope._dataCustomer = {};

    //retrieve employees listing from API
  $http({
    'method'  : 'GET',
    'url'   : '/token' 
  }).success(function(response){
    // console.log(response);
    $scope._token     = response;

    getResultsPageCustomer(1);

  }).error(function(response){
      console.log(response);
  });

  $scope.searchDBCustomer = function(){
      if($scope.searchTextCustomer.length >= 1){
        // console.log($scope.libraryTempCustomer);
        if($.isEmptyObject($scope.libraryTempCustomer)){
              $scope.libraryTempCustomer = $scope._dataCustomer;
              $scope.totalItemsTempCustomer = $scope.totalItemsCustomer;
              $scope._dataCustomer = {};
        }
        getResultsPageCustomer(1);
      }else{
        // console.log('masuk');
          if(!$.isEmptyObject($scope.libraryTempCustomer)){
              $scope._dataCustomer = $scope.libraryTempCustomer ;
              $scope.totalItemsCustomer = $scope.totalItemsTempCustomer;
              $scope.libraryTempCustomer = {};
          }
      }
  }

  $scope.pageChangedCustomer = function(newPage) {
    getResultsPageCustomer(newPage);
  };
/*

*/
  function getResultsPageCustomer(pageNumber) {
      var _url = $scope._token['url']+ $scope.subUrlCustomer;
      if(! $.isEmptyObject($scope.libraryTempCustomer)){
        $http({
          'method'  : 'GET',
          // 'url'     : API_URL+$scope.subUrlCustomer+'?search='+$scope.searchTextCustomer+'&page='+pageNumber 
          'url'     : _url+'?search='+$scope.searchTextCustomer+'&page='+pageNumber 
        }).success(function(response){
          // console.log(response);
          $scope._dataCustomer     = response.data;
          $scope.totalItemsCustomer   = response.total;
          $scope.tableCustomer = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
            console.log(response);
        });
      }else{
        $http({
          'method'  : 'GET',
          // 'url'   : API_URL+$scope.subUrlCustomer+'?page='+pageNumber 
          'url'   : _url+'?page='+pageNumber 
        }).success(function(response){
          // console.log($scope._dataCustomer);
          $scope._dataCustomer     = response.data;
          $scope.totalItemsCustomer   = response.total;
          $scope.tableCustomer = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
          console.log(response);
        });
      }
  }

}); 
