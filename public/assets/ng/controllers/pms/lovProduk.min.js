app.controller('lovProdukController', function($scope, $http){//, parameter){//, API_URL) {
	$scope.libraryTempProduk = {};
  $scope.totalItemsTempProduk = {};
  $scope.totalItemsProduk = 0;
  $scope.subUrlProduk = '/pms/produk';
  $scope._token = {};
  $scope._dataSpks = {};

  // $scope.parameter = parameter;
  $scope.dataModal = {}

  // console.log($scope.parameter);
  // $scope.dataModal['f_customer'] = $scope.parameter['_f_customer'];

    //retrieve employees listing from API
  $http({
    'method'  : 'GET',
    'url'   : '/token' 
  }).success(function(response){
    // console.log(response);
    $scope._token     = response;

    getResultsPageProduk(1);

  }).error(function(response){
      console.log(response);
  });

    //retrieve employees listing from API
    // getResultsPageProduk(1);

    $scope.searchDBProduk = function(){
        if($scope.searchTextProduk.length >= 1){
          // console.log($scope.libraryTempProduk);
          if($.isEmptyObject($scope.libraryTempProduk)){
                $scope.libraryTempProduk = $scope._dataProduk;
                $scope.totalItemsTempProduk = $scope.totalItemsProduk;
                $scope._dataProduk = {};
          }
          getResultsPageProduk(1);
        }else{
          // console.log('masuk');
            if(!$.isEmptyObject($scope.libraryTempProduk)){
                $scope._dataProduk = $scope.libraryTempProduk ;
                $scope.totalItemsProduk = $scope.totalItemsTempProduk;
                $scope.libraryTempProduk = {};
            }
        }
    }

    $scope.pageChangedProduk = function(newPage) {
      getResultsPageProduk(newPage);
    };
/*

*/
  function getResultsPageProduk(pageNumber) {
      var _url = $scope._token['url']+ $scope.subUrlProduk;
      if(! $.isEmptyObject($scope.libraryTempProduk)){
        $http({
          'method'  : 'GET',
          'url'     : _url+'?search='+$scope.searchTextSpks+'&page='+pageNumber+'&lov=true' 
          // 'url'     : API_URL+$scope.subUrlProduk+'?search='+$scope.searchTextProduk+'&page='+pageNumber+'&lov=true' 
        }).success(function(response){
          // console.log(response);
          $scope._dataProduk     = response.data;
          $scope.totalItemsProduk   = response.total;
          $scope.tableProduk = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
            console.log(response);
        });
      }else{
        $http({
          'method'  : 'GET',
          'url'   : _url+'?page='+pageNumber+'&lov=true'
          // 'url'   : API_URL+$scope.subUrlProduk+'?page='+pageNumber+'&lov=true' 
        }).success(function(response){
          // console.log(response);
          $scope._dataProduk     = response.data;
          $scope.totalItemsProduk   = response.total;
          $scope.tableProduk = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
          console.log(response);
        });
      }
  }

});
