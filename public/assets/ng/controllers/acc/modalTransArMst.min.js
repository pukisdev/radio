app.controller('modalTransArMstController', function($scope, $http, $uibModalInstance, parameter){//, API_URL) {
	$scope.libraryTempBank = {};
  $scope.totalItemsTempBank = {};
  $scope.totalItemsBank = 0;
  $scope.subUrlBank = '/acc/transAr';
  $scope._token = {};
  $scope._dataBank = {};

  $scope.parameter = parameter;
  $scope.dataModal = {}

  // console.log($scope.parameter);
  // $scope.dataModal['f_customer'] = $scope.parameter['_f_customer'];

    //retrieve employees listing from API
  $http({
    'method'  : 'GET',
    'url'   : '/token' 
  }).success(function(response){
    // console.log(response);
    $scope._token     = response;

    getResultsPageBank(1);

  }).error(function(response){
      console.log(response);
  });

  $scope.searchDBBank = function(){
      if($scope.searchTextBank.length >= 1){
        // console.log($scope.libraryTempBank);
        if($.isEmptyObject($scope.libraryTempBank)){
              $scope.libraryTempBank = $scope._dataBank;
              $scope.totalItemsTempBank = $scope.totalItemsBank;
              $scope._dataBank = {};
        }
        getResultsPageBank(1);
      }else{
        // console.log('masuk');
          if(!$.isEmptyObject($scope.libraryTempBank)){
              $scope._dataBank = $scope.libraryTempBank ;
              $scope.totalItemsBank = $scope.totalItemsTempBank;
              $scope.libraryTempBank = {};
          }
      }
  }

  $scope.pageChangedBank = function(newPage) {
    getResultsPageBank(newPage);
  };

  $scope.cancel = function () {
    $uibModalInstance.dismiss('cancel');
  };

  $scope.lovBankSelected = function(_element){
    // console.log(_element);
    $uibModalInstance.close(_element);
  }

  $scope.save = function(modalstate, id){
      alert('oke');
      /*var _url = $scope._token['url']+ $scope.subUrl;
      if($.isEmptyObject($scope._token)) return false;
      console.log($scope.dataForm['tgl_terima']);
      $scope.dataForm['keterangan'] = $scope.dataForm['keterangan'].toString();
      // $scope.dataForm['tgl_terima'] = [[ $scope.dataForm['tgl_terima']  | date:'MM/dd/yyyy @ h:mma' ]];
      // console.log('tanggal : ' + $scope.dataForm['tgl_terima']);
      $http({
        'method'  : ($scope.dataForm['no_bukti']) ? 'PUT' : 'POST',
        'url'     : _url + (($scope.dataForm['no_bukti']) ? '/'+$scope.dataForm['no_bukti'] : ''),
        'data'    : $.param($scope.dataForm),
        'headers' : {'Content-Type': 'application/x-www-form-urlencoded'}
      }).success(function(response){
        console.log(response);
        // $scope.toggle('edit',response.id_pnwr);
        showData(response);
        $scope.modalstate = 'edit'; 

        $.gritter.add({
              title: 'Application',
              text: 'Data Berhasil Disimpan',
              fade_out_speed: 5000
          });
      }).error(function(error){
        console.log(error);
      });*/
    }

  function getResultsPageBank(pageNumber) {
      var _url = $scope._token['url']+ $scope.subUrlBank;

      if(! $.isEmptyObject($scope.libraryTempBank)){
        $http({
          'method'  : 'GET',
          'url'     : _url+'?search='+$scope.searchTextBank+'&page='+pageNumber 
        }).success(function(response){
          // console.log(response);
          $scope._dataBank      = response.data;
          $scope.totalItemsBank = response.total;
          $scope.tableBank      = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
            console.log(response);
        });
      }else{
        $http({
          'method'  : 'GET',
          'url'   : _url+'?page='+pageNumber//+'&f_customer='+$scope.parameter['_f_customer'] 
        }).success(function(response){
          // console.log($scope._dataBank);
          $scope._dataBank        = response.data;
          $scope.totalItemsBank   = response.total;
          $scope.tableBank        = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
          console.log(response);
        });
      }
  }

}); 
