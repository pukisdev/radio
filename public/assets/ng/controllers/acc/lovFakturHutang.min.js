app.controller('lovFakturHutangController', function($scope, $http, $uibModalInstance, parameter){//, API_URL) {
	$scope.libraryTempFakturHutang = {};
  $scope.totalItemsTempFakturHutang = {};
  $scope.totalItemsFakturHutang = 0;
  $scope.subUrlFakturHutang = '/acc/lovFakturHutang';
  $scope._token = {};
  $scope._dataFakturHutang = {};

  $scope.parameter = parameter;
  $scope.dataModal = {}

  $http({
    'method'  : 'GET',
    'url'   : '/token' 
  }).success(function(response){
    // console.log(response);
    $scope._token     = response;

    getResultsPageFakturHutang(1);

  }).error(function(response){
      console.log(response);
  });

  $scope.searchDBFakturHutang = function(){
      if($scope.searchTextFakturHutang.length >= 1){
        // console.log($scope.libraryTempFakturHutang);
        if($.isEmptyObject($scope.libraryTempFakturHutang)){
              $scope.libraryTempFakturHutang = $scope._dataFakturHutang;
              $scope.totalItemsTempFakturHutang = $scope.totalItemsFakturHutang;
              $scope._dataFakturHutang = {};
        }
        getResultsPageFakturHutang(1);
      }else{
        // console.log('masuk');
          if(!$.isEmptyObject($scope.libraryTempFakturHutang)){
              $scope._dataFakturHutang = $scope.libraryTempFakturHutang ;
              $scope.totalItemsFakturHutang = $scope.totalItemsTempFakturHutang;
              $scope.libraryTempFakturHutang = {};
          }
      }
  }

  $scope.pageChangedFakturHutang = function(newPage) {
    getResultsPageFakturHutang(newPage);
  };

  $scope.cancel = function () {
    $uibModalInstance.dismiss('cancel');
  };

  $scope.lovFakturHutangSelected = function(_element){
    // console.log(_element);
    $uibModalInstance.close(_element);
  }

/*

*/
  function getResultsPageFakturHutang(pageNumber) {
      var _url = $scope._token['url']+ $scope.subUrlFakturHutang;

      if(! $.isEmptyObject($scope.libraryTempFakturHutang)){
        $http({
          'method'  : 'GET',
          'url'     : _url+'?search='+$scope.searchTextFakturHutang+'&page='+pageNumber+'&coa_id='+$scope.parameter['_coa_id']  
        }).success(function(response){
          // console.log(response);
          $scope._dataFakturHutang      = response.data;
          $scope.totalItemsFakturHutang = response.total;
          $scope.tableFakturHutang      = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
            console.log(response);
        });
      }else{
        $http({
          'method'  : 'GET',
          'url'   : _url+'?page='+pageNumber+'&coa_id='+$scope.parameter['_coa_id'] 
        }).success(function(response){
          // console.log($scope._dataFakturHutang);
          $scope._dataFakturHutang        = response.data;
          $scope.totalItemsFakturHutang   = response.total;
          $scope.tableFakturHutang        = { TotalItems : response.total, CurrentItems : response.to };
        }).error(function(response){
          console.log(response);
        });
      }
  }

}); 
